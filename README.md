ここでは使い方について説明しています。

## 準備 (pip installで使えるようにする予定です)
- Pythonのプログラムを実行できる環境
- AnkiConnect (アドオン番号：2055492159)

が必要です。\
また、以下のコマンドを実行して、事前にライブラリをインストールしてください。
```bash
pip install beautifulsoup4 psutil requests natasha
```
以上の準備が終わったらRtoJ-anki-register.pyを実行すると、初回設定後すぐに利用できます。

使用時は事前に Anki を起動しておく必要があります。設定すれば自動起動させることもできます(設定は初回実行時の案内にしたがってください)。

## モード一覧(デフォルト := 空文字 + ENTER)：

### 1. <単語登録モード>
#### f : ファイルから読み込み (file)

config 内で input_file に指定したファイル(.txt, .mdなど)から全てのロシア語を抜き出して読み込む。

#### i : キーボード入力から読み込み (input)
キーボード入力で読み込まれた単語または文を読み込む。空文字を送ると終了。

単語の変化形が含まれている場合は、そこに含まれる単語の原形を推測する。

最初の改行文字までを扱うため、改行が含まれる文章はあらかじめ詰めておく必要がある。

文脈の無い単語の変化形を入力すると誤推測の可能性あり。(例えばтестеはтест(テスト), тесто(パンなどの生地), тесть(舅)のいずれの可能性もある)

#### p : 部分一致検索して登録 (partial match)
入力した文字列を部分文字列に持つ単語を調べる。ヒットした単語を全て出力する。

<!--「カードにしますか？」に対して「y」と入力すると、意味を1, 2つずつまとめたカードを作成する。-->

#### r : コトバンクからランダム抽出 (random)
コトバンクに収録されている語をランダムに抽出する。

このモードでは「追加するカード枚数」「クイックモードにするか」を求められる。

    追加するカード枚数：ランダムに抽出する単語の数
    クイックモード(デフォルトでY)：y → 単語の意味を確認せずに追加する。
                                n → 単語が追加されるたびに意味を確認するか尋ねられる。

#### o : unfound_wordsを整理する (organize)
見つからなかった単語が出力されるunfound_wordsを読み込んで、単語の重複を省き、整列して再びunfound_wordsに出力する。

その際にコトバンクに見つかった単語はAnkiに登録される。

#### b : 戻る (back)
モード選択へ戻る。

### 2. <その他>
#### c : カードを追加するデッキを変更する (change deck)
カードを追加する先のデッキを変更する。

#### s : 設定の確認/変更 (setting)
現在の設定を確認/変更できる。

「言語」「Ankiのパス」「言語に応じたフィールド名」「デッキ名」

「選択中のデッキ番号」「読み込むファイルのパス」「出力先のファイルのパス」

が確認できる。

設定の変更をする場合、初期設定で入力する全ての項目について設定し直すことができる。

#### b : 戻る (back)
モード選択へ戻る。

### 3. <やめる>
#### q : やめる (quit)
プログラムを終了する。
                            
## ～～仕様～～
ロシア語の入力に対して正規化処理(小文字化、記号除去など)を行います。そのため、人名などの大文字で始まる単語には対応していません。

ロシア語以外の入力は無視されます。特に、読み込みファイルに日本語のメモ書きなどが含まれていても大丈夫です。

追加されるカードには、"表面" に「入力された単語」、"裏面" に「単語の意味および用例」がそれぞれ書き込まれます。

"表面" の単語はアクセント位置を赤文字にしています。

単語の意味および用例は "コトバンク -プログレッシブロシア語辞典(露和編)-" よりスクレイピングして取得しています。

短時間に大量のリクエストをすることによるスクレイピング先への過剰なサーバー負荷を避けるため、平均3秒のランダムな待機時間を設定しています。

何らかの理由により見つからなかった単語は、プログラムの実行場所と同じディレクトリにファイルを生成してそこに書き込みます。そこに出力された単語はこのプログラムで対応できないので、自分で意味を調べてください。


## ～～注意事項・お願い～～
"特定少数の私的利用かつ非商用利用" をお願いします。よって、再配布や営利目的の利用は禁止します。

より快適な利用のための改造は基本的に自由にできますが、「sleep(uniform(2, 4))を削除する」「ウイルスを仕込む」など、他人に迷惑がかかる改造はおやめください。

上記が守られなかった場合に生じた問題において、著作者は一切責任を負いません。

<!-- ## ～～その他～～
バグや不具合の報告は GitHub (https://github.com/Nasu726/) または note (https://note.com/nasu726/) まで。  -->

